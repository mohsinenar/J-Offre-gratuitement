webpackJsonp([0],{"SO+j":function(e,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var t=i("ueVu"),a=i("yviF"),o=i.n(a),r={data:function(){return{imageRef:null,progress:0,uploadTask:{},downloadURL:"./no-pictures.svg"}},name:"imageuploader",props:{image:File,ImageIndex:Number},computed:{ProgressType:function(){return this.progress>=60?"is-success":this.progress>=30?"is-warning":this.progress<30?"is-danger":void 0}},methods:{Uploadfiled:function(e){console.error(e)},UploadCompleted:function(){var e=this;this.uploadTask.snapshot.ref.getDownloadURL().then(function(s){e.downloadURL=s;var i={fullPath:s,ImageIndex:e.ImageIndex};e.$emit("UploadCompleted",i)})},startUpload:function(){var e=this;console.log("startLoading");var s=Math.random()+"_"+this.image.size;this.imageRef=o.a.storage().ref().child("Listings/"+s),this.uploadTask=this.imageRef.put(this.image),this.uploadTask.on(o.a.storage.TaskEvent.STATE_CHANGED,function(s){e.progress=s.bytesTransferred/s.totalBytes*100},function(s){e.Uploadfiled(s)},function(){e.UploadCompleted()})},CancelImage:function(e){this.uploadTask.cancel(),this.$emit("CancelImage",e)}},mounted:function(){this.startUpload()}},n={render:function(){var e=this,s=e.$createElement,i=e._self._c||s;return i("div",{staticClass:"container"},[i("div",{staticClass:"status has-background-danger"}),e._v(" "),i("b-button",{staticClass:"cancel  is-small",attrs:{type:"is-danger","icon-right":"times"},on:{click:function(s){e.CancelImage(e.ImageIndex)}}}),e._v(" "),i("img",{staticStyle:{height:"100%",width:"100% z-index:1"},attrs:{src:e.downloadURL,alt:""}}),e._v(" "),i("div",{staticStyle:{width:"100%",position:"relative"}},[i("b-progress",{staticClass:"Loadingbare",attrs:{size:"is-small","show-value":!0,type:e.ProgressType,value:e.progress}})],1)],1)},staticRenderFns:[]};var l={data:function(){return{imagesErrors:!1,infoErrors:{title:{hasErrors:!1,message:""},category:{hasErrors:!1,message:""},Description:{hasErrors:!1,message:""},city:{hasErrors:!1,message:""},phone:{hasErrors:!1,message:""}},categories:["informatique et multimedia","Vêtements","Sports et Loisirs","Animaux","Cours et Formations","Services","Offres de stages","Autres"],Cities:["Tout le Maroc","Casablanca","Agadir","Al Hoceima","Béni Mellal","El Jadida","Errachidia","Fès","Kénitra","Khénifra","Khouribga","Larache","Marrakech","Meknès","Nador","Ouarzazate","Oujda","Rabat","Safi","Settat","Salé","Tanger","Taza","Tétouan","-- AUTRES VILLES --"],NewListing:{title:"",category:"",city:"",conditions:"",PhoneNumber:"",Description:"",images:[],ownerId:null,CreatedAt:(new Date).valueOf(),Keywords:[],IsActive:!0},MaxImagesRechedLimit:!1,images:[],currentStep:0}},methods:{Next:function(e){switch(this.currentStep){case 0:this.validate(e,this.NewListing.title,this.infoErrors.title);break;case 1:this.validate(e,this.NewListing.category,this.infoErrors.category);break;case 2:this.validate(e,this.NewListing.Description,this.infoErrors.Description);break;case 3:this.validate(e,this.NewListing.city,this.infoErrors.city);break;case 6:this.validate(e,this.NewListing.PhoneNumber,this.infoErrors.phone)&&this.addlisting();break;default:e.action()}},validate:function(e,s,i){return console.log(s),""==s?(i.message="(required)",i.hasErrors=!0,!1):(e.action(),i.message="",i.hasErrors=!1,!0)},UploadCompleted:function(e){this.NewListing.images[e.ImageIndex]=e.fullPath},CancelImage:function(e){this.images.splice(e,1),this.NewListing.images.splice(e,1)},ShowSuccess:function(e){this.$router.push({name:"viewListing",params:{ListingID:e}})},ShowError:function(e){console.log(e),this.AddErrors=e.code},addlisting:function(){var e=this;this.$store.dispatch("showLoading");var s,i=t.a.collection("Listings").doc();this.NewListing.ownerId=this.$store.state.logedUser.uid,this.NewListing.CreatedAt=(new Date).valueOf(),this.NewListing.Keywords=(s=this.NewListing,(s.Description+" "+s.title+" "+s.category+" "+s.city).toLowerCase().split(" ")),console.log(this.NewListing.Keywords),i.set(this.NewListing).then(function(s){console.log(s),e.$store.dispatch("openMessage",{text:"bien ajouter",type:"is-success"}),e.ShowSuccess(i.id)}).catch(function(s){e.$store.dispatch("openMessage",{text:s.code,type:"is-danger"})}).finally(function(){e.$store.dispatch("hideLoading")})}},computed:{NSelectedImages:function(){return this.images.length}},mounted:function(){},watch:{NSelectedImages:function(e){this.MaxImagesRechedLimit=e>=4}},name:"AddListingForm",components:{imageuploader:i("VU/8")(r,n,!1,function(e){i("eS7n")},null,null).exports}},c={render:function(){var e=this,s=e.$createElement,i=e._self._c||s;return i("div",[i("section",[i("b-steps",{attrs:{position:"left","label-position":"Bottom",size:"is-small",animated:"",rounded:!1,vertical:!0,hasNavigation:!1},scopedSlots:e._u([{key:"navigation",fn:function(s){var t=s.previous,a=s.next;return[i("div",{staticStyle:{padding:"10px",bottom:"5px",width:"100%"}},[i("div",{staticClass:"columns is-mobile"},[i("div",{staticClass:"column is-6 is-paddingless"},[i("b-button",{directives:[{name:"show",rawName:"v-show",value:!t.disabled,expression:"!previous.disabled"}],attrs:{expanded:"",outlined:"",type:"is-primary","icon-pack":"fas","icon-left":"backward"},on:{click:function(e){e.preventDefault(),t.action(e)}}},[e._v("Previous")])],1),e._v(" "),i("div",{staticClass:"column is-paddingless is-6"},[i("b-button",{directives:[{name:"show",rawName:"v-show",value:!a.disabled,expression:"!next.disabled"}],attrs:{expanded:"",outlined:"",type:"is-primary","icon-pack":"fas","icon-right":"forward"},on:{click:function(s){s.preventDefault(),e.Next(a)}}},[e._v("Suivant")])],1)])])]}}]),model:{value:e.currentStep,callback:function(s){e.currentStep=s},expression:"currentStep"}},[i("b-step-item",{attrs:{icon:"info"}},[i("hr"),e._v(" "),i("b-message",{directives:[{name:"show",rawName:"v-show",value:e.infoErrors.title.hasErrors,expression:"infoErrors.title.hasErrors"}],attrs:{size:"is-small",type:"is-warning"}},[e._v(e._s(e.infoErrors.title.message))]),e._v(" "),i("b-message",{attrs:{size:"is-small",type:"is-info"}},[e._v("Lorem ipsum dolor, sit")]),e._v(" "),i("b-field",{attrs:{label:"J'offre Gratuitement:","label-position":"outside"}},[i("b-input",{attrs:{size:"is-medium"},model:{value:e.NewListing.title,callback:function(s){e.$set(e.NewListing,"title",s)},expression:"NewListing.title"}})],1)],1),e._v(" "),i("b-step-item",{attrs:{icon:"info"}},[i("b-message",{directives:[{name:"show",rawName:"v-show",value:e.infoErrors.category.hasErrors,expression:"infoErrors.category.hasErrors"}],attrs:{size:"is-small",type:"is-warning"}},[e._v(e._s(e.infoErrors.category.message))]),e._v(" "),i("b-message",{attrs:{size:"is-small",type:"is-info"}},[e._v("Merci de choisir la categorie correspond de votre offre:")]),e._v(" "),i("b-field",{attrs:{label:"categorie:"}},[i("b-select",{attrs:{placeholder:"maroc",icon:"globe",expanded:"","icon-pack":"fas"},model:{value:e.NewListing.category,callback:function(s){e.$set(e.NewListing,"category",s)},expression:"NewListing.category"}},e._l(e.categories,function(s,t){return i("option",{key:t,domProps:{value:s}},[e._v(e._s(s))])}))],1)],1),e._v(" "),i("b-step-item",{attrs:{icon:"info"}},[i("b-message",{directives:[{name:"show",rawName:"v-show",value:e.infoErrors.Description.hasErrors,expression:"infoErrors.Description.hasErrors"}],attrs:{size:"is-small",type:"is-warning"}},[e._v(e._s(e.infoErrors.Description.message))]),e._v(" "),i("b-message",{attrs:{size:"is-small",type:"is-info"}},[e._v("describe your offre in some words")]),e._v(" "),i("b-field",{attrs:{"label-position":"outside",label:"Description de l'offre"}},[i("b-input",{attrs:{size:"is-small",maxlength:"200",type:"textarea"},model:{value:e.NewListing.Description,callback:function(s){e.$set(e.NewListing,"Description",s)},expression:"NewListing.Description"}})],1)],1),e._v(" "),i("b-step-item",{attrs:{icon:"info"}},[i("b-message",{directives:[{name:"show",rawName:"v-show",value:e.infoErrors.city.hasErrors,expression:"infoErrors.city.hasErrors"}],attrs:{size:"is-small",type:"is-warning"}},[e._v(e._s(e.infoErrors.city.message))]),e._v(" "),i("b-message",{attrs:{size:"is-small",type:"is-info"}},[e._v("ville:")]),e._v(" "),i("b-field",{attrs:{label:"ville:"}},[i("b-select",{attrs:{placeholder:"maroc",icon:"globe",expanded:"","icon-pack":"fas"},model:{value:e.NewListing.city,callback:function(s){e.$set(e.NewListing,"city",s)},expression:"NewListing.city"}},e._l(e.Cities,function(s,t){return i("option",{key:t,domProps:{value:s}},[e._v(e._s(s))])}))],1)],1),e._v(" "),i("b-step-item",{attrs:{icon:"images"}},[i("section",[i("b-message",{attrs:{size:"is-small",type:"is-info"}},[e._v("ajouter des images pour votre offre")])],1),e._v(" "),i("div",{staticClass:"section"},[i("div",{staticClass:"columns is-clearfixed"},[e._l(e.images,function(s,t){return i("div",{key:t,staticClass:"is-pulled-left  imageuploader"},[i("imageuploader",{attrs:{ImageIndex:t,image:s},on:{UploadCompleted:e.UploadCompleted,CancelImage:e.CancelImage}})],1)}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.MaxImagesRechedLimit,expression:"!MaxImagesRechedLimit"}],staticClass:"imageuploader is-pulled-left"},[i("b-field",{staticStyle:{border:"1px dashed red","text-align":"center",width:"100%",height:"100%","line-height":"7"},attrs:{"label-position":"outside"}},[i("b-upload",{attrs:{accept:"image/gif, image/jpeg, image/png",multiple:""},model:{value:e.images,callback:function(s){e.images=s},expression:"images"}},[i("b-icon",{attrs:{icon:"upload",size:"is-medium"}})],1)],1)],1)],2)])]),e._v(" "),i("b-step-item",{attrs:{icon:"info"}},[i("b-message",{attrs:{size:"is-small",type:"is-info"}},[e._v("conditions")]),e._v(" "),i("b-field",{attrs:{"label-position":"outside",label:"conditions"}},[i("b-input",{attrs:{size:"is-small",type:"textarea"},model:{value:e.NewListing.conditions,callback:function(s){e.$set(e.NewListing,"conditions",s)},expression:"NewListing.conditions"}})],1)],1),e._v(" "),i("b-step-item",{attrs:{icon:"info"}},[i("b-message",{directives:[{name:"show",rawName:"v-show",value:e.infoErrors.phone.hasErrors,expression:"infoErrors.phone.hasErrors"}],attrs:{size:"is-small",type:"is-warning"}},[e._v(e._s(e.infoErrors.phone.message))]),e._v(" "),i("b-message",{attrs:{size:"is-small",type:"is-info"}},[e._v("votre numero de telephone")]),e._v(" "),i("b-field",{attrs:{"label-position":"outside",label:"votre numero de telephone"}},[i("b-input",{attrs:{size:"is-medium",type:"number",min:10},model:{value:e.NewListing.PhoneNumber,callback:function(s){e.$set(e.NewListing,"PhoneNumber",s)},expression:"NewListing.PhoneNumber"}})],1)],1),e._v(" "),i("b-step-item")],1)],1)])},staticRenderFns:[]};var d={name:"AddListing",components:{AddListingForm:i("VU/8")(l,c,!1,function(e){i("j0ks")},null,null).exports}},m={render:function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"home"},[s("AddListingForm")],1)},staticRenderFns:[]},u=i("VU/8")(d,m,!1,null,null,null);s.default=u.exports},eS7n:function(e,s){},j0ks:function(e,s){}});
//# sourceMappingURL=0.208143707cec696c8191.js.map